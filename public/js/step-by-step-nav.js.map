{"version":3,"file":"step-by-step-nav.js","names":["window","NHSUK","Modules","AppStepNav","actions","rememberShownStep","stepNavSize","sessionStoreLink","activeLinkClass","activeStepClass","activeLinkHref","uniqueId","start","$element","addClass","removeClass","hasClass","filter","length","$steps","find","$stepHeaders","totalSteps","totalLinks","$showOrHideAllButton","data","stepNavTracker","StepNavTracker","getTextForInsertedElements","addButtonstoSteps","addShowHideAllButton","addShowHideToggle","addAriaControlsAttrForShowHideAllButton","ensureOnlyOneActiveLink","showPreviouslyOpenedSteps","bindToggleForSteps","bindToggleShowHideAllButton","bindComponentLinkClicks","showText","attr","hideText","showAllText","hideAllText","prepend","each","linkText","headerIsOpen","$","append","$stepHeader","closest","ariaControlsValue","first","setAllStepsShownState","isShown","stepView","StepView","setIsShown","push","saveToSessionStorage","JSON","stringify","removeFromSessionStorage","loadFromSessionStorage","id","indexOf","setShowHideAllText","$step","$title","contentId","wrapInner","click","event","toggle","stepIsOptional","toggleClick","StepToggleClick","track","rememberStepState","parse","thisstep","shown","i","splice","linkClick","componentLinkClick","thisLinkHref","setOnlyThisLinkActive","setActiveStepClass","key","value","sessionStorage","setItem","getItem","removeItem","clicked","parent","$activeLinks","lastClicked","removeActiveStateFromAllButCurrent","current","toString","remove","removeAttr","on","shouldshowAll","text","html","label","shownSteps","$stepElement","$titleLink","$stepContent","title","trim","element","show","hide","isHidden","numberOfContentItems","toggleClass","trackClick","$target","target","trackingOptions","trackingLabel","dimension28","trackingAction","locateClickElement","isOptional","stepIndex","index","clickedOnIcon","iconType","clickedOnHeading","linkPosition","category","action","options"],"sources":["step-by-step-nav.js"],"sourcesContent":["// Based on https://github.com/alphagov/govuk_publishing_components/blob/v22.0.0/app/assets/javascripts/govuk_publishing_components/components/step-by-step-nav.js\n\n/* eslint-env jquery */\n\nwindow.NHSUK = window.NHSUK || {}\nwindow.NHSUK.Modules = window.NHSUK.Modules || {};\n\n(function (Modules) {\n  'use strict'\n\n  Modules.AppStepNav = function () {\n    var actions = {} // stores text for JS appended elements 'show' and 'hide' on steps, and 'show/hide all' button\n    var rememberShownStep = false\n    var stepNavSize\n    var sessionStoreLink = 'nhsuk-step-nav-active-link'\n    var activeLinkClass = 'app-step-nav__list-item--active'\n    var activeStepClass = 'app-step-nav__step--active'\n    var activeLinkHref = '#content'\n    var uniqueId\n\n    this.start = function ($element) {\n      // Indicate that js has worked\n      $element.addClass('app-step-nav--active')\n\n      // Prevent FOUC, remove class hiding content\n      $element.removeClass('js-hidden')\n\n      stepNavSize = $element.hasClass('app-step-nav--large') ? 'Big' : 'Small'\n      rememberShownStep = !!$element.filter('[data-remember]').length && stepNavSize === 'Big'\n      var $steps = $element.find('.js-step')\n      var $stepHeaders = $element.find('.js-toggle-panel')\n      var totalSteps = $element.find('.js-panel').length\n      var totalLinks = $element.find('app-step-nav__link').length\n      var $showOrHideAllButton\n\n      uniqueId = $element.data('id') || false\n\n      if (uniqueId) {\n        sessionStoreLink = sessionStoreLink + '_' + uniqueId\n      }\n\n      var stepNavTracker = new StepNavTracker(totalSteps, totalLinks, uniqueId)\n\n      getTextForInsertedElements()\n      addButtonstoSteps()\n      addShowHideAllButton()\n      addShowHideToggle()\n      addAriaControlsAttrForShowHideAllButton()\n\n      ensureOnlyOneActiveLink()\n      showPreviouslyOpenedSteps()\n\n      bindToggleForSteps(stepNavTracker)\n      bindToggleShowHideAllButton(stepNavTracker)\n      bindComponentLinkClicks(stepNavTracker)\n\n      function getTextForInsertedElements () {\n        actions.showText = $element.attr('data-show-text')\n        actions.hideText = $element.attr('data-hide-text')\n        actions.showAllText = $element.attr('data-show-all-text')\n        actions.hideAllText = $element.attr('data-hide-all-text')\n      }\n\n      function addShowHideAllButton () {\n        $element.prepend('<div class=\"app-step-nav__controls\"><button aria-expanded=\"false\" class=\"app-step-nav__button app-step-nav__button--controls js-step-controls-button\">' + actions.showAllText + '</button></div>')\n      }\n\n      function addShowHideToggle () {\n        $stepHeaders.each(function () {\n          var linkText = actions.showText // eslint-disable-line no-unused-vars\n\n          if (headerIsOpen($(this))) {\n            linkText = actions.hideText\n          }\n\n          if (!$(this).find('.js-toggle-link').length) {\n            $(this).find('.js-step-title-button').append(\n              '<span class=\"app-step-nav__toggle-link js-toggle-link\" aria-hidden=\"true\" hidden></span>'\n            )\n          }\n        })\n      }\n\n      function headerIsOpen ($stepHeader) {\n        return (typeof $stepHeader.closest('.js-step').data('show') !== 'undefined')\n      }\n\n      function addAriaControlsAttrForShowHideAllButton () {\n        var ariaControlsValue = $element.find('.js-panel').first().attr('id')\n\n        $showOrHideAllButton = $element.find('.js-step-controls-button')\n        $showOrHideAllButton.attr('aria-controls', ariaControlsValue)\n      }\n\n      // called by show all/hide all, sets all steps accordingly\n      function setAllStepsShownState (isShown) {\n        var data = []\n\n        $.each($steps, function () {\n          var stepView = new StepView($(this))\n          stepView.setIsShown(isShown)\n\n          if (isShown) {\n            data.push($(this).attr('id'))\n          }\n        })\n\n        if (isShown) {\n          saveToSessionStorage(uniqueId, JSON.stringify(data))\n        } else {\n          removeFromSessionStorage(uniqueId)\n        }\n      }\n\n      // called on load, determines whether each step should be open or closed\n      function showPreviouslyOpenedSteps () {\n        var data = loadFromSessionStorage(uniqueId) || []\n\n        $.each($steps, function () {\n          var id = $(this).attr('id')\n          var stepView = new StepView($(this))\n\n          // show the step if it has been remembered or if it has the 'data-show' attribute\n          if ((rememberShownStep && data.indexOf(id) > -1) || typeof $(this).attr('data-show') !== 'undefined') {\n            stepView.setIsShown(true)\n          } else {\n            stepView.setIsShown(false)\n          }\n        })\n\n        if (data.length > 0) {\n          $showOrHideAllButton.attr('aria-expanded', true)\n          setShowHideAllText()\n        }\n      }\n\n      function addButtonstoSteps () {\n        $.each($steps, function () {\n          var $step = $(this)\n          var $title = $step.find('.js-step-title')\n          var contentId = $step.find('.js-panel').first().attr('id')\n\n          $title.wrapInner(\n            '<span class=\"js-step-title-text\"></span>'\n          )\n\n          $title.wrapInner(\n            '<button ' +\n            'class=\"app-step-nav__button app-step-nav__button--title js-step-title-button\" ' +\n            'aria-expanded=\"false\" aria-controls=\"' + contentId + '\">' +\n            '</button>'\n          )\n        })\n      }\n\n      function bindToggleForSteps (stepNavTracker) {\n        $element.find('.js-toggle-panel').click(function (event) {\n          var $step = $(this).closest('.js-step')\n\n          var stepView = new StepView($step)\n          stepView.toggle()\n\n          var stepIsOptional = typeof $step.data('optional') !== 'undefined'\n          var toggleClick = new StepToggleClick(event, stepView, $steps, stepNavTracker, stepIsOptional)\n          toggleClick.track()\n\n          setShowHideAllText()\n          rememberStepState($step)\n        })\n      }\n\n      // if the step is open, store its id in session store\n      // if the step is closed, remove its id from session store\n      function rememberStepState ($step) {\n        if (rememberShownStep) {\n          var data = JSON.parse(loadFromSessionStorage(uniqueId)) || []\n          var thisstep = $step.attr('id')\n          var shown = $step.hasClass('step-is-shown')\n\n          if (shown) {\n            data.push(thisstep)\n          } else {\n            var i = data.indexOf(thisstep)\n            if (i > -1) {\n              data.splice(i, 1)\n            }\n          }\n          saveToSessionStorage(uniqueId, JSON.stringify(data))\n        }\n      }\n\n      // tracking click events on links in step content\n      function bindComponentLinkClicks (stepNavTracker) {\n        $element.find('.js-link').click(function (event) {\n          var linkClick = new componentLinkClick(event, stepNavTracker, $(this).attr('data-position')) // eslint-disable-line no-new, new-cap\n          linkClick.track()\n          var thisLinkHref = $(this).attr('href')\n\n          if ($(this).attr('rel') !== 'external') {\n            saveToSessionStorage(sessionStoreLink, $(this).attr('data-position'))\n          }\n\n          if (thisLinkHref === activeLinkHref) {\n            setOnlyThisLinkActive($(this))\n            setActiveStepClass()\n          }\n        })\n      }\n\n      function saveToSessionStorage (key, value) {\n        window.sessionStorage.setItem(key, value)\n      }\n\n      function loadFromSessionStorage (key) {\n        return window.sessionStorage.getItem(key)\n      }\n\n      function removeFromSessionStorage (key) {\n        window.sessionStorage.removeItem(key)\n      }\n\n      function setOnlyThisLinkActive (clicked) {\n        $element.find('.' + activeLinkClass).removeClass(activeLinkClass)\n        clicked.parent().addClass(activeLinkClass)\n      }\n\n      // if a link occurs more than once in a step nav, the backend doesn't know which one to highlight\n      // so it gives all those links the 'active' attribute and highlights the last step containing that link\n      // if the user clicked on one of those links previously, it will be in the session store\n      // this code ensures only that link and its corresponding step have the highlighting\n      // otherwise it accepts what the backend has already passed to the component\n      function ensureOnlyOneActiveLink () {\n        var $activeLinks = $element.find('.js-list-item.' + activeLinkClass)\n\n        if ($activeLinks.length <= 1) {\n          return\n        }\n\n        var lastClicked = loadFromSessionStorage(sessionStoreLink) || $element.find('.' + activeLinkClass).first().attr('data-position')\n\n        // it's possible for the saved link position value to not match any of the currently duplicate highlighted links\n        // so check this otherwise it'll take the highlighting off all of them\n        if (!$element.find('.js-link[data-position=\"' + lastClicked + '\"]').parent().hasClass(activeLinkClass)) {\n          lastClicked = $element.find('.' + activeLinkClass).first().find('.js-link').attr('data-position')\n        }\n        removeActiveStateFromAllButCurrent($activeLinks, lastClicked)\n        setActiveStepClass()\n      }\n\n      function removeActiveStateFromAllButCurrent ($activeLinks, current) {\n        $activeLinks.each(function () {\n          if ($(this).find('.js-link').attr('data-position').toString() !== current.toString()) {\n            $(this).removeClass(activeLinkClass)\n            $(this).find('.visuallyhidden').remove()\n          }\n        })\n      }\n\n      function setActiveStepClass () {\n        $element.find('.' + activeStepClass).removeClass(activeStepClass).removeAttr('data-show')\n        $element.find('.' + activeLinkClass).closest('.app-step-nav__step').addClass(activeStepClass).attr('data-show', '')\n      }\n\n      function bindToggleShowHideAllButton (stepNavTracker) {\n        $showOrHideAllButton = $element.find('.js-step-controls-button')\n        $showOrHideAllButton.on('click', function () {\n          var shouldshowAll\n\n          if ($showOrHideAllButton.text() === actions.showAllText) {\n            $showOrHideAllButton.text(actions.hideAllText)\n            $element.find('.js-toggle-link').html(actions.hideText)\n            shouldshowAll = true\n\n            stepNavTracker.track('pageElementInteraction', 'stepNavAllShown', {\n              label: actions.showAllText + ': ' + stepNavSize\n            })\n          } else {\n            $showOrHideAllButton.text(actions.showAllText)\n            $element.find('.js-toggle-link').html(actions.showText)\n            shouldshowAll = false\n\n            stepNavTracker.track('pageElementInteraction', 'stepNavAllHidden', {\n              label: actions.hideAllText + ': ' + stepNavSize\n            })\n          }\n\n          setAllStepsShownState(shouldshowAll)\n          $showOrHideAllButton.attr('aria-expanded', shouldshowAll)\n          setShowHideAllText()\n\n          return false\n        })\n      }\n\n      function setShowHideAllText () {\n        var shownSteps = $element.find('.step-is-shown').length\n        // Find out if the number of is-opens == total number of steps\n        if (shownSteps === totalSteps) {\n          $showOrHideAllButton.text(actions.hideAllText)\n        } else {\n          $showOrHideAllButton.text(actions.showAllText)\n        }\n      }\n    }\n\n    function StepView ($stepElement) {\n      var $titleLink = $stepElement.find('.js-step-title-button')\n      var $stepContent = $stepElement.find('.js-panel')\n\n      this.title = $stepElement.find('.js-step-title-text').text().trim()\n      this.element = $stepElement\n\n      this.show = show\n      this.hide = hide\n      this.toggle = toggle\n      this.setIsShown = setIsShown\n      this.isShown = isShown\n      this.isHidden = isHidden\n      this.numberOfContentItems = numberOfContentItems\n\n      function show () {\n        setIsShown(true)\n      }\n\n      function hide () {\n        setIsShown(false)\n      }\n\n      function toggle () {\n        setIsShown(isHidden())\n      }\n\n      function setIsShown (isShown) {\n        $stepElement.toggleClass('step-is-shown', isShown)\n        $stepContent.toggleClass('js-hidden', !isShown)\n        $titleLink.attr('aria-expanded', isShown)\n        $stepElement.find('.js-toggle-link').html(isShown ? actions.hideText : actions.showText)\n      }\n\n      function isShown () {\n        return $stepElement.hasClass('step-is-shown')\n      }\n\n      function isHidden () {\n        return !isShown()\n      }\n\n      function numberOfContentItems () {\n        return $stepContent.find('.js-link').length\n      }\n    }\n\n    function StepToggleClick (event, stepView, $steps, stepNavTracker, stepIsOptional) {\n      this.track = trackClick\n      var $target = $(event.target)\n\n      function trackClick () {\n        var trackingOptions = { label: trackingLabel(), dimension28: stepView.numberOfContentItems().toString() }\n        stepNavTracker.track('pageElementInteraction', trackingAction(), trackingOptions)\n      }\n\n      function trackingLabel () {\n        return $target.closest('.js-toggle-panel').attr('data-position') + ' - ' + stepView.title + ' - ' + locateClickElement() + ': ' + stepNavSize + isOptional()\n      }\n\n      // returns index of the clicked step in the overall number of steps\n      function stepIndex () { // eslint-disable-line no-unused-vars\n        return $steps.index(stepView.element) + 1\n      }\n\n      function trackingAction () {\n        return (stepView.isHidden() ? 'stepNavHidden' : 'stepNavShown')\n      }\n\n      function locateClickElement () {\n        if (clickedOnIcon()) {\n          return iconType() + ' click'\n        } else if (clickedOnHeading()) {\n          return 'Heading click'\n        } else {\n          return 'Elsewhere click'\n        }\n      }\n\n      function clickedOnIcon () {\n        return $target.hasClass('js-toggle-link')\n      }\n\n      function clickedOnHeading () {\n        return $target.hasClass('js-step-title-text')\n      }\n\n      function iconType () {\n        return (stepView.isHidden() ? 'Minus' : 'Plus')\n      }\n\n      function isOptional () {\n        return (stepIsOptional ? ' ; optional' : '')\n      }\n    }\n\n    function componentLinkClick (event, stepNavTracker, linkPosition) {\n      this.track = trackClick\n\n      function trackClick () {\n        var trackingOptions = { label: $(event.target).attr('href') + ' : ' + stepNavSize }\n        var dimension28 = $(event.target).closest('.app-step-nav__list').attr('data-length')\n\n        if (dimension28) {\n          trackingOptions.dimension28 = dimension28\n        }\n\n        stepNavTracker.track('stepNavLinkClicked', linkPosition, trackingOptions)\n      }\n    }\n\n    // A helper that sends a custom event request to Google Analytics if\n    // the NHSUK module is setup\n    function StepNavTracker (totalSteps, totalLinks, uniqueId) {\n      this.track = function (category, action, options) {\n        // noop\n      }\n    }\n  }\n})(window.NHSUK.Modules)\n"],"mappings":"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","ignoreList":[]}